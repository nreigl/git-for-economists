---
title: "Git for economists"
author: "Heili Hein (TalTech) & Nicolas Reigl (TalTech / Eesti Pank)"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  xaringan::moon_reader:
    css: [default, metropolis, metropolis-fonts]
    lib_dir: libs
    nature:
      highlightStyle: GitHub
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(knitr)
opts_chunk$set(
  fig.align="center", #fig.width=6, fig.height=4.5,
  # out.width="748px", #out.length="520.75px",
  dpi=300, #fig.path='Figs/',
  cache=T#, echo=F, warning=F, message=F
  )
```

# Introduction
- **WHY?**
  - Git has become a core skill in many professions
  - good to stay in contact with other researchers, share skills
  
- **WHAT?**
  - 1.5 hours introduction to Git & GitHub 
  - split between a **presentation** and a **live-tutorial** 
  - ask questions whenever you feel like it!

<br/>

*This project has received funding from the European Union’s Horizon 2020 Research and Innovation programme under Grant Agreement No 952574.*

<div align="center">
<img src="https://oecd-opsi.org/wp-content/uploads/2020/02/Horizon-2020-1024x513.jpg" height=100>
</div>

---
class: inverse, center, middle
name: prologue

# Prologue

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

---
# To do

- [] Add credits
- [] Add merge conflicts part
- [] Improve "Learning git steps"
- [DONE] Date in the YAML: Heili, why does the date bug out?
- [] Git figure on title slide? Rewrite title logo .css in libs
- [DONE] Add H2020 logo with the flag and the sentence
- [NOTE TO NIC] I deleted two slides that I felt were part of the introduction and redid the intro slide a bit. Changed the location of the resources slide.

---
# What is Git?

Git is officially defined as a *distributed version control system* (VCS)

- A system that tracks changes to our project files over time
  - record project changes and go back to specific versions of tracked files, at any given point in time
- System can be used by many people to collaborate efficiently
  - each developer can have their own version of the project, distributed on their computer
  - later the individual versions of the project can be merged and adapted to the main version of the project

---
# What is GitHub?

- [GitHub](GitHub.com) is an online platform built for collaborative software development that uses the git protocol
- Git and GitHub are distinct things
- GitHub provides free unlimited public repos
- Paid subscriptions for a wide range of services
  - University affiliation can get you more free stuff

Alternatives

- [Gitlab](https://about.gitlab.com)
- [Bitbucket](https://bitbucket.org/product)
- Host your private git server


---
# Why learn git (as an economist)?

> The master-economist must possess a rare combination of gifts .... He must be mathematician, historian, statesman, philosopher—in some degree....

John Maynard Keynes

Economists today:

- Statistical programming
- Collaborate (interdisciplinary) (on open source projects)
- *New*: Teach online

---
# Economists work with code

but it seems we are not adopting many important tools from the experts on code

Why?

- Learning new things is costly
- Rethink our workflows
- Its simply not thought!


---
# Who uses Git?

- [Instituations (NY FED)](https://GitHub.com/FRBNY-DSGE)
- [Econ Projects (QuantEcon Project)](https://GitHub.com/QuantEcon/)
- [University Departments (ScPo Department of Economics)](https://GitHub.com/ScPoEcon)
- [Econ software platforms (Dynare)](https://git.dynare.org/Dynare)
- [Econometric packages (FixEst Package)](https://GitHub.com/lrberge/fixest)
- [Individual economists (Victor Chernozhukov)](https://www.victorchernozhukov.com/code-and-notebooks)

---
# Why use version control (VC)?

Do you have files like final.txt, final_revised.txt, final_revised2.txt, final_revised2_revised.txt?

<div align="center">
<img src="http://phdcomics.com/comics/archive/phd101212s.gif" height=400>
</div>

'Piled Higher and Deeper' by Jorge Cham www.phdcomics.com

---
# VC with git

  - Keep track of changes to text files line-by-line over time
  - Keep track of what you changed between different versions
  - Branching and merging: Experiment safely; integrate when done (robustness checks, revisions)
  - Revert any change if needed
  - Back up and distribute copies of files
  - Co-authored research is common: Version control allows easier tracking of collaboration and changes
    - Work offline and asynchronously
    - Collaborate remotely, centralized,  in real time

---
# VC visualized - Changes

<div align="center">
<img src="https://uidaholib.GitHub.io/get-git/images/versions.png" height=400>
</div>

What is version control? https://uidaholib.GitHub.io/get-git/1why.html


---
# VC visualized - Branches

<div align="center">
<img src="https://uidaholib.GitHub.io/get-git/images/branch-merge.png" height=400>
</div>

What is version control? https://uidaholib.GitHub.io/get-git/1why.html


---
# Reproducability


- Many journals require data & code with submissions
- Proper version control makes reproducing results easier
 - GiHub: DOI integration, off-the-shelf-licensing

VC and open sourcing of your code operationalises the idea of open science and reproducability


Not directly VC but good to know
- GitHub offers tools for code testing and code deployment

---
# Teaching

- Using Git to teach encourages students to use git and GitHub themselves --> important industry skill
- Allows to update and test new teaching material before you make it public to your students
- Easier to upload and distribute new teaching material (when using GitHub)

---
# Resources

Best in class:

- [Git docs](https://git-scm.com/doc)
- [Atlasian git tutorial](https://www.atlassian.com/git/tutorials)
- [Software Carpentry git tutorial](https://swcarpentry.GitHub.io/git-novice/)
- [QuantEcon git tutorial](https://julia.quantecon.org/more_julia/version_control.html)
- [Flight rules for Git](https://GitHub.com/k88hudson/git-flight-rules/blob/master/README.md)

---
class: inverse, center, middle
name: learning

# Learning Git(Hub)
<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>


---
# Git concepts

- **repository(repo)**: a collection of files and their history
- **commit**: a snapshot of your files at a given time
- **Staging area**: where you list files that will go into your next commit
- **(local) Repository**: where the commits are stored; ie, it contains the full history of previous versions of the files in the repository, and relevant metadata
- **(remote) Repository**: a version of the repository hosted elsewhere
- **gitignore**: a file that declares what should **NOT** be tracked
- **Main (or Master)**: Main version of the code
- **Branches**: sequence of commits which can trace *alternative* history and versions of your code in the repo
- **HEAD**: pointer to branch ("Where your next commit would go")

---
# Basic Git commands

- **git init**: start a new repository in the working directory
- **git status**: query the state of your director
- **git add**: add new or modified files to the staging area 
 - **git add .**: adds all file excluding those defined in the .gitignore
 - **git add -u**: updates the index of an already staged file 
 - **git add -A**: adds all file **Including** those defined in the .gitignore
- **git commit**: commit changes in the index
- **git branch**: create a branch  or list branches
- **git checkout**: switch within a branch or between branches
- **git diff**: show what changed wrt. the last commit or index
- **git log**: show the commit history
- **git push**: send your local changes to a remote server
- **git pull (git fetch; git merge)**: get last changes from a remote
- **git clone**: create local copy of public source project

---
# Setup

- Download [git](https://git-scm.com/downloads)
- Install and if necessary set path
- Terminal editor
- Various shell addons for various terminals
- Configure your name and & email


```bash
git config --global user.name "Your name"
git config --global user.email "your@email.com"
```

Tips:
```bash
git config --global core.editor "code --wait" # sets VS code as core editor
git config --global -e
```

Possible trap:
```bash
git config --global core.autocrlf true # Windows
git config --global core.autocrlf input # OSX
```

---
# Collaborate with others:

  - Create GitHub account
  - Star, clone, and fork other projects
  - GitHub Issues are a great way to collaborate (and learn new things)
    - Learn how to create Minimal Working Examples (MWE)


---
# Editors

Command line based editors: 

 - Terminal with git capable shell
 - Git shell

Graphical User Interfaces (GUIs)

- RStudio
- VSCode
  - Gitlens
- Gitkraken

---
# Git workflows


<div align="center">
<img src="https://miro.medium.com/max/577/1*AAU1VCV8LMHvVPBYxMBsxg.png" height=450>
</div>

A Review of Git Workflow Management https://medium.com/@hengfeng/a-review-of-git-workflow-management-7f9fbebd9370


---
# Basic Workflow

1. Create an empty folder
2. Init repository (**git init**)
3. Add files & annotate them
4. Add the files to the staging area (**git add**)
5. Commit the files (**git commit**)



---
# Personal remote workflow (Option 1)

- Steps 1-5
- Create an *empty* repo on GitHub
- Link the GitHub remote to your local repo
- Push from the local repo to the remote
- After working on the local repo, repeat steps 4-5
- If the working tree is not *clean* before pulling from remote, repeat steps 4-5
- Pull from the remote to the local repo

Pros:
 - Decide when to push to GitHub
 - Language specific project Environments (Julia Environments)

Cons:
 - Not a good workflow for non-empty remotes
 - In case of non language environment -> no README.md, no liscence, no .gitignore

Always pull from the upstream repo *before* you push any changes

---
# Personal remote workflow (Option 2)

- Create a new repo on GitHub
   - Add README.md, .gitignore and liscene. Can also add collaborators
- Clone remote to an emppty, non-VC local directory
- Work on your local repo
- Push from the local to the remote repo

Pros:
 - Creating the repo on GitHub first means that it will always be "upstream" of your (and any other) local copies
  - In effect, this allows GitHub to act as the central node in the distributed VC network
  - Especially valuable when you are collaborating on a project with others

Cons:
 - Not every project goes on GitHub
 - Certain local projects *might* collide with GitHub created repos


 Always pull from the upstream repo *before* you push any changes

---
# Collaborating workflow

- Fork a public repo
- Clone the *forked* repo to local empty folder
- (*Optional: create a dev branch*)
- Work on the forked repo (*main or dev and then merge back to main*)
- Push back to the personal fork
- Create a pull request
- Review process of pull request

---
# Workflow visualized

<div align="center">
<img src="https://uidaholib.GitHub.io/get-git/images/workflow.png" height=400>
</div>

Workflow https://uidaholib.GitHub.io/get-git/3workflow.html




---
class: inverse, center, middle
name: live

# Live tutorial
<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

<div align="center">
<img src="https://i.kym-cdn.com/photos/images/original/000/000/130/disaster-girl.jpg" height=400>
</div>


---
class: inverse, center, middle
name: questions

# Questions
<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>


---
class: inverse, center, middle
name: appendix

# Appendix
<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>


---
# Working with remotes

- `git fecht, git merge` is better than `git pull` if you suspect merge conflicts
- Do **NOT** `git rebase` public open source repos

<div align="center">
<img src="https://assets-global.website-files.com/5d7678efce0c5739c9bc3bf1/5dc320c753535c09450e4d76_git-rebase-2-example.png" height=400>
</div>

Regain Control of Branches with Git Rebase --onto https://www.headway.io/blog/regain-control-of-branches-with-git-rebase-onto


---
# Further tips

- Master the [shell](https://GitHub.com/uo-ec510-2020-spring/lectures/tree/master/03-shell)
- git with r: Jenny Bryan's amazing [guide](http://happygitwithr.com)
